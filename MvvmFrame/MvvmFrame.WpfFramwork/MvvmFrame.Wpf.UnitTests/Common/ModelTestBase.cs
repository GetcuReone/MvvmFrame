using Microsoft.VisualStudio.TestTools.UnitTesting;
using MvvmFrame.Wpf.UnitTests.Common.Asserts;
using MvvmFrame.Wpf.UnitTests.Common.Entities;

namespace MvvmFrame.Wpf.UnitTests.Common
{
    [TestClass]
    public abstract class ModelTestBase: ViewModelTestBase
    {
        protected ModelTest Model { get; private set; }

        [TestInitialize]
        public override void Initialize()
        {
            base.Initialize();

            Model = ViewModel.GetModel<ModelTest>();

            AssertViewModel.AssertCallMethods(ViewModel, getModelCallNumber: 1);
            AssertCallCreateObject(0);
            Assert.AreEqual(ViewModel.UiServices, Model.UiServices, "UiServices must be match");
        }

        protected override void AssertCallCreateObject(int createObjectCallNumber)
            => base.AssertCallCreateObject(createObjectCallNumber + 1);


    }
}
